# Telegram-бот для конференции

Многофункциональный Telegram-бот для организации и проведения конференций с поддержкой ролевой модели, системой баллов, управлением мерчем и отслеживанием кандидатов.

## Содержание

- [Обзор](#обзор)
- [Функциональные возможности](#функциональные-возможности)
- [Ролевая модель](#ролевая-модель)
- [Установка и настройка](#установка-и-настройка)
- [Структура проекта](#структура-проекта)
- [Сценарии использования](#сценарии-использования)
- [Интеграции](#интеграции)
- [Тестирование](#тестирование)
- [Развертывание](#развертывание)
- [Требования к серверу](#требования-к-серверу)
- [Лицензия](#лицензия)

## Обзор

Telegram-бот для конференции предоставляет комплексное решение для организаторов, участников, стендистов и HR-специалистов. Бот позволяет автоматизировать процессы регистрации участников, учета посещений стендов, распределения и учета мерча, а также поиска и отслеживания потенциальных кандидатов.

Основные преимущества:
- Ролевая модель с разграничением прав доступа
- Система баллов для геймификации участия в конференции
- QR-коды для быстрой идентификации и учета активностей
- Аналитика и статистика по всем аспектам конференции
- Инструменты для HR-специалистов по работе с кандидатами
- Управление мерчем и его распределением

## Функциональные возможности

### Общие функции
- Регистрация пользователей с сохранением профиля
- Система ролей с разными правами доступа
- Генерация и сканирование QR-кодов
- Система баллов и вознаграждений
- Каталог мерча с возможностью заказа
- Список стендов с информацией и статистикой
- Подписки на уведомления
- Рассылка сообщений

### Административные функции
- Управление пользователями и их ролями
- Управление стендами и их владельцами
- Управление мерчем и его доступностью
- Просмотр статистики и аналитики
- Массовая рассылка сообщений
- Мониторинг активности и ошибок

## Ролевая модель

Бот поддерживает четыре основные роли с различными правами доступа:

### Гость
Базовая роль для всех зарегистрированных пользователей.
- Просмотр каталога мерча
- Заказ мерча за баллы
- Просмотр баланса баллов и истории транзакций
- Просмотр списка стендов
- Управление подписками на уведомления

### Стендист
Представитель компании на стенде.
- Все функции гостя
- Сканирование QR-кодов посетителей для начисления баллов
- Просмотр статистики посещений стенда
- Управление информацией о своем стенде

### HR-специалист
Представитель HR-отдела, ищущий потенциальных кандидатов.
- Все функции гостя
- Отметка пользователей как потенциальных кандидатов
- Добавление заметок о кандидатах
- Просмотр списка отмеченных кандидатов
- Экспорт данных о кандидатах

### Администратор
Организатор конференции с полным доступом ко всем функциям.
- Все функции других ролей
- Управление пользователями и их ролями
- Управление стендами и мерчем
- Просмотр общей статистики
- Рассылка сообщений всем пользователям
- Настройка параметров бота

## Установка и настройка

### Предварительные требования
- Python 3.9 или выше
- MongoDB 4.4 или выше
- Токен Telegram-бота (получить у [@BotFather](https://t.me/BotFather))

### Шаги установки

1. Клонируйте репозиторий:
```bash
git clone https://github.com/yourusername/conference_bot.git
cd conference_bot
```

2. Создайте и активируйте виртуальное окружение:
```bash
python -m venv venv
source venv/bin/activate  # для Linux/Mac
venv\Scripts\activate     # для Windows
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

4. Создайте файл `.env` на основе `.env.example`:
```bash
cp .env.example .env
```

5. Отредактируйте файл `.env`, указав ваши настройки:
```
TELEGRAM_TOKEN=your_telegram_token_here
MONGO_URI=mongodb://localhost:27017/conference_bot
ADMIN_CODE=your_admin_code_here
```

6. Запустите бота:
```bash
python main.py
```

7. Для запуска планировщика рассылок (опционально):
```bash
python modules/broadcaster.py run_scheduler
```

### Первоначальная настройка

1. Запустите бота и отправьте команду `/start`
2. Зарегистрируйтесь как обычный пользователь
3. Используйте команду `/admin` и введите код администратора из файла `.env`
4. Теперь вы можете использовать административные функции для настройки бота

## Структура проекта

```
conference_bot/
├── main.py                  # Основной модуль бота
├── requirements.txt         # Зависимости проекта
├── .env.example             # Пример файла конфигурации
├── modules/                 # Модули функциональности
│   ├── role_management.py   # Управление ролями
│   ├── merch_module.py      # Управление мерчем
│   ├── points_system.py     # Система баллов
│   ├── candidate_management.py # Управление кандидатами
│   ├── statistics_analytics.py # Статистика и аналитика
│   ├── admin_tools.py       # Инструменты администратора
│   ├── subscription_feature.py # Функция подписки
│   └── broadcaster.py       # Модуль рассылки
├── utils/                   # Вспомогательные утилиты
│   ├── db_connector.py      # Подключение к базе данных
│   └── qr_generator.py      # Генератор QR-кодов
└── data/                    # Директория для данных
    ├── qr_codes/            # Сгенерированные QR-коды
    └── statistics/          # Файлы статистики и отчетов
```

## Сценарии использования

### Регистрация нового пользователя
1. Пользователь запускает бота командой `/start`
2. Бот предлагает зарегистрироваться
3. Пользователь вводит свои данные (имя, фамилия, должность, уровень, компания)
4. Пользователь дает согласие на обработку данных
5. Бот регистрирует пользователя и выдает персональный QR-код
6. Пользователь получает доступ к функциям гостя

### Посещение стенда
1. Пользователь подходит к стенду компании
2. Стендист выбирает функцию "Сканировать QR-код посетителя"
3. Пользователь показывает свой QR-код
4. Стендист сканирует QR-код через бота
5. Бот начисляет баллы пользователю за посещение стенда
6. Пользователь получает уведомление о начислении баллов

### Заказ мерча
1. Пользователь выбирает "Каталог мерча" в меню
2. Бот показывает доступный мерч с описанием и стоимостью в баллах
3. Пользователь выбирает желаемый мерч
4. Бот проверяет наличие достаточного количества баллов
5. Бот оформляет заказ и списывает баллы
6. Пользователь получает уведомление о успешном заказе

### Отметка кандидата (для HR)
1. HR-специалист выбирает "Отметить кандидата" в меню
2. HR сканирует QR-код потенциального кандидата
3. Бот отмечает пользователя как кандидата
4. HR может добавить заметку о кандидате
5. Кандидат добавляется в список отмеченных кандидатов HR

### Административные действия
1. Администратор использует команду `/admin` и вводит код доступа
2. Администратор получает доступ к панели управления
3. Администратор может управлять пользователями, стендами, мерчем
4. Администратор может просматривать статистику и отправлять рассылки

## Интеграции

### QR-коды
Бот использует библиотеку `qrcode` для генерации QR-кодов и `pyzbar` для их декодирования. QR-коды используются для:
- Идентификации пользователей
- Отметки посещения стендов
- Учета выдачи мерча
- Регистрации на мероприятия

### База данных MongoDB
Бот использует MongoDB для хранения всех данных:
- Профили пользователей
- Информация о стендах
- Каталог мерча
- Транзакции баллов
- Заказы мерча
- Заметки о кандидатах
- Статистика и логи

### Аналитика и отчеты
Бот может генерировать различные отчеты и визуализации:
- Статистика посещений стендов
- Динамика регистраций пользователей
- Распределение пользователей по ролям
- Популярность мерча
- Статистика по кандидатам

## Тестирование

### Тестирование регистрации
1. Запустите бота командой `/start`
2. Пройдите процесс регистрации, вводя тестовые данные
3. Убедитесь, что бот корректно сохраняет данные и выдает QR-код
4. Проверьте доступность функций гостя после регистрации

### Тестирование ролей
1. Зарегистрируйтесь как администратор (используйте команду `/admin` и код из `.env`)
2. Создайте тестовых пользователей с разными ролями
3. Проверьте доступность функций для каждой роли
4. Убедитесь, что пользователи не могут получить доступ к функциям, не предназначенным для их роли

### Тестирование системы баллов
1. Используя аккаунт стендиста, отсканируйте QR-код тестового пользователя
2. Убедитесь, что баллы начисляются корректно
3. Проверьте историю транзакций баллов
4. Попробуйте заказать мерч и убедитесь, что баллы списываются правильно

### Тестирование функций HR
1. Используя аккаунт HR, отметьте тестового пользователя как кандидата
2. Добавьте заметку о кандидате
3. Проверьте список отмеченных кандидатов
4. Попробуйте экспортировать данные о кандидатах

### Тестирование административных функций
1. Войдите как администратор
2. Создайте новый стенд и назначьте владельца
3. Добавьте новый мерч в каталог
4. Отправьте тестовую рассылку
5. Проверьте статистику и аналитику

## Развертывание

### Локальное развертывание
Следуйте инструкциям в разделе [Установка и настройка](#установка-и-настройка).

### Развертывание на сервере

#### Heroku
1. Создайте аккаунт на [Heroku](https://heroku.com)
2. Установите [Heroku CLI](https://devcenter.heroku.com/articles/heroku-cli)
3. Инициализируйте Git-репозиторий и создайте приложение Heroku:
```bash
git init
heroku create your-app-name
```
4. Добавьте MongoDB add-on или используйте внешнюю базу данных:
```bash
heroku addons:create mongolab
```
5. Настройте переменные окружения:
```bash
heroku config:set TELEGRAM_TOKEN=your_token
heroku config:set ADMIN_CODE=your_admin_code
```
6. Разверните приложение:
```bash
git add .
git commit -m "Initial commit"
git push heroku master
```
7. Запустите бота:
```bash
heroku ps:scale web=1
```

#### DigitalOcean
1. Создайте дроплет на [DigitalOcean](https://digitalocean.com)
2. Подключитесь к дроплету по SSH
3. Установите необходимые пакеты:
```bash
apt-get update
apt-get install python3 python3-pip git mongodb
```
4. Клонируйте репозиторий и настройте бота:
```bash
git clone https://github.com/yourusername/conference_bot.git
cd conference_bot
pip3 install -r requirements.txt
cp .env.example .env
nano .env  # Отредактируйте настройки
```
5. Настройте автозапуск с помощью systemd:
```bash
nano /etc/systemd/system/conference_bot.service
```
Содержимое файла:
```
[Unit]
Description=Conference Telegram Bot
After=network.target

[Service]
User=root
WorkingDirectory=/root/conference_bot
ExecStart=/usr/bin/python3 /root/conference_bot/main.py
Restart=always

[Install]
WantedBy=multi-user.target
```
6. Активируйте и запустите сервис:
```bash
systemctl enable conference_bot
systemctl start conference_bot
```

## Требования к серверу

### Минимальные требования
- Python 3.9+
- MongoDB 4.4+
- 1 ГБ RAM
- 10 ГБ дискового пространства

### Рекомендуемые требования
- Python 3.10+
- MongoDB 5.0+
- 2 ГБ RAM
- 20 ГБ SSD
- Выделенный сервер или VPS

## Лицензия

Этот проект распространяется под лицензией MIT. См. файл LICENSE для получения дополнительной информации.
